profile: "USCore-R4"
trigger_events:
  - ORU^R01
resources:
  - hl7_path: "PID.3[0].1"
    fhir_resource: "Patient"
    fhir_path: "identifier[0].value"
    required: true
  - hl7_path: "PID.5[0].1"
    fhir_resource: "Patient"
    fhir_path: "name[0].family"
  - hl7_path: "PID.5[0].2"
    fhir_resource: "Patient"
    fhir_path: "name[0].given[]"
  - hl7_path: "PID.7"
    fhir_resource: "Patient"
    fhir_path: "birthDate"
    transform: "toDate"

  - hl7_path: "PV1.19.1"
    fhir_resource: "Encounter"
    fhir_path: "identifier[0].value"

  - hl7_path: "OBR.4.1"
    fhir_resource: "DiagnosticReport"
    fhir_path: "code.coding[]"
    transform: "loinc:{value}"

  - hl7_path: "OBX[*].3.1"
    fhir_resource: "Observation"
    fhir_path: "code.coding[]"
    transform: "loinc:{value}"
  - hl7_path: "OBX[*].5"
    fhir_resource: "Observation"
    fhir_path: "valueQuantity.value"
    transform: "decimal"
  - hl7_path: "OBX[*].6.1"
    fhir_resource: "Observation"
    fhir_path: "valueQuantity.unit"

bundle_links:
  - subject: "Observation"
    target: "Patient"
    path: "subject.reference"
    format: "Patient/{id}"
  - encounter: "Observation"
    target: "Encounter"
    path: "encounter.reference"
    format: "Encounter/{id}"
