{% extends "layout.html" %}
{% block extra_head %}
<link rel="stylesheet" href="{{ request.url_for('static', path='css/interop_extras.css') }}" />
<script type="module" src="{{ request.url_for('static', path='js/interop_ui.js') }}"></script>
{% endblock %}
{% block content %}
{% if urls is not defined %}
  {% set urls = {} %}
{% endif %}
{% set root = request.scope.get('root_path', '') %}

<h2>Interoperability</h2>
<div id="debug-state-badge"
     class="micro muted"
     hx-get="{{ root }}/api/diag/debug/state?format=html"
     hx-trigger="load"
     hx-target="#debug-state-badge"
     hx-swap="outerHTML">Loading debug switch…</div>

<div class="feature-tabs mt" id="interop-feature-bar">
  <button class="tab feature-pill active" data-open-card="card-gen" data-feature="gen">Generate Message</button>
  <button class="tab feature-pill" data-open-card="card-deid" data-feature="deid">De‑Identify Message</button>
  <button class="tab feature-pill" data-open-card="card-validate" data-feature="val">Validate Message</button>
  <button class="tab feature-pill" data-open-card="card-mllp" data-feature="mllp">Transport (MLLP)</button>
</div>

<details id="card-gen" class="card collapsible" open>
  <summary>Generate Message <span class="minimax"></span></summary>
  <div class="card-body">
    {% include "ui/interop/_generate_panel.html" %}
  </div>
</details>

<details id="card-deid" class="card collapsible">
  <summary>De‑Identify Message <span class="minimax"></span></summary>
  <div class="card-body">
    {% include "ui/interop/_deid_panel.html" %}
  </div>
</details>

<details id="card-validate" class="card collapsible">
  <summary>Validate Message <span class="minimax"></span></summary>
  <div class="card-body">
    {% include "ui/interop/_validate_panel.html" %}
  </div>
</details>

<details id="card-mllp" class="card collapsible">
  <summary>Transport (MLLP) &amp; FHIR Options <span class="minimax"></span></summary>
  <div class="card-body">
    {% include "ui/interop/_mllp_panel.html" %}
  </div>
</details>

<details id="card-debug" class="card collapsible">
  <summary>Generator Debug Log <span class="minimax"></span></summary>
  <div class="card-body">
    {% include "ui/interop/_debug_log_panel.html" %}
  </div>
</details>
{% endblock %}
