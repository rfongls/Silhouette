<details id="validate-panel" class="card collapsible" open>
  <summary>âœ“ Validate <span class="minimax"></span></summary>
  <div class="module-body">
    <form id="validate-form"
          hx-post="{{ urls.api_validate_report }}"
          hx-encoding="multipart/form-data"
          hx-target="#validate-report"
          hx-swap="innerHTML"
          hx-headers='{"Accept":"text/html"}'>
      <input type="hidden" name="format" value="html" />
      <label class="text-caption muted" for="validate-msg">HL7 Message (paste)</label>
      <textarea class="codepane limit10" name="message" id="validate-msg" rows="8" placeholder="MSH|^~\&amp;|..."></textarea>

      <div class="row gap small mt" role="group" aria-label="Validate options">
        <label class="text-caption muted" for="validate-template" style="min-width:12rem;">Validation template</label>
        <input class="input" name="val_template" id="validate-template"
               placeholder="template id (optional)" list="std-val-templates"
               hx-get="{{ urls.ui_val_templates }}" hx-trigger="load"
               hx-target="#std-val-templates" hx-swap="outerHTML" />
        <span class="text-caption muted">or upload .hl7</span>
        <input class="input" type="file" name="file" accept=".hl7,.txt" />
        <button class="btn" type="submit">Run Validate</button>
      </div>
    </form>

    <datalist id="std-val-templates">
      {% for template in val_templates %}
        <option value="{{ template }}"></option>
      {% endfor %}
    </datalist>

    <label class="text-caption muted mt" for="validate-output">Output</label>
    <pre id="validate-output" class="codepane limit10" aria-live="polite"></pre>

    <details class="card collapsible" id="validate-report-panel">
      <summary>
        <div class="summary-title">Validation report</div>
        <div class="summary-meta"><span class="minimax"></span></div>
      </summary>
      <div class="module-body">
        <div class="row gap small">
          <button type="button" class="btn btn-sm" data-role="validate-report-refresh">Refresh report</button>
          <button type="button" class="btn btn-sm" data-role="validate-report-clear">Clear</button>
          <span class="micro muted">Filters and drill-downs render inside the report.</span>
        </div>
        <div id="validate-report" class="codepane limit10" aria-live="polite"></div>
      </div>
    </details>

    {% with source_selector = '#validate-output' %}
      {% include "ui/standalone/partials/_action_tray.html" %}
    {% endwith %}
  </div>
</details>
