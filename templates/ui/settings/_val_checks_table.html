{% set existing = checks if checks is defined and checks else [] %}
{% set blanks = [{'segment':'','field':'','required':True,'pattern':'','allowed_values':''}] * 3 %}
{% set rows = existing + blanks %}
<table class="table mt">
  <thead>
    <tr>
      <th scope="col">Segment</th>
      <th scope="col">Field</th>
      <th scope="col">Required</th>
      <th scope="col">Pattern</th>
      <th scope="col">Allowed values</th>
    </tr>
  </thead>
  <tbody>
    {% for check in rows %}
      <tr>
        <td><input class="input" name="checks-segment" value="{{ check.segment | default('') }}" placeholder="MSH" /></td>
        <td><input class="input" name="checks-field" value="{{ check.field | default('') }}" placeholder="9" /></td>
        <td class="center">
          <input type="checkbox" name="checks-required" value="{{ loop.index0 }}" {% if check.required %}checked{% endif %} />
        </td>
        <td><input class="input" name="checks-pattern" value="{{ check.pattern | default('') }}" placeholder="^ADT\\^A01$" /></td>
        <td><input class="input" name="checks-allowed" value="{{ check.allowed_values | default('') }}" placeholder="ADT^A01;ADT^A04" /></td>
      </tr>
    {% endfor %}
  </tbody>
</table>
<p class="muted micro">Separate allowed values with semicolons. Leave blank for no restriction.</p>
