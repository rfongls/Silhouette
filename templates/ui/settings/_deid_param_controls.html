{# templates/ui/settings/_deid_param_controls.html #}
{% set A = (act or action or '').strip().lower() %}
{% set M = (mode or param_mode or 'preset').strip().lower() %}

{% if A == 'replace' %}
  <div class="grid two">
    <label>Replacement
      <input class="input" name="repl" value="{{ repl or '' }}" placeholder="e.g. [REDACTED]">
    </label>
  </div>

{% elif A == 'regex_redact' %}
  <div class="grid two">
    <label>Pattern (regex)
      <input class="input" name="pattern" value="{{ pattern or '' }}" placeholder="e.g. \\d{3}-\\d{2}-\\d{4}">
    </label>
  </div>

{% elif A == 'regex_replace' %}
  <div class="grid two">
    <label>Pattern (regex)
      <input class="input" name="pattern" value="{{ pattern or '' }}" placeholder="e.g. (\\d{3})\\d{2}(\\d{4})">
    </label>
    <label>Replacement
      <input class="input" name="repl" value="{{ repl or '' }}" placeholder="e.g. \\1**\\2">
    </label>
  </div>

{% elif A == 'preset' %}
  <div class="grid two">
    <label>Parameter mode
      <select class="input" name="param_mode" id="m-param-mode"
              hx-get="{{ request.url_for('ui_settings_deid_param_controls') }}"
              hx-target="#param-controls"
              hx-trigger="change"
              hx-include="#deid-modal-form"
              hx-swap="innerHTML">
        <option value="preset" {{ 'selected' if M=='preset' else '' }}>preset list</option>
        <option value="free"   {{ 'selected' if M=='free'   else '' }}>free text</option>
      </select>
    </label>
  </div>

  {% if M == 'preset' %}
    <div class="grid two">
      <label>Preset
        <select class="input" name="param_preset">
          {% for opt in preset_options %}
            <option value="{{ opt }}" {{ 'selected' if (param_preset or '')==opt else '' }}>{{ opt }}</option>
          {% endfor %}
        </select>
      </label>
    </div>
  {% else %}
    <div class="grid two">
      <label>Free text
        <input class="input" name="param_free" value="{{ param_free or '' }}" placeholder="e.g. Jane Doe">
      </label>
    </div>
  {% endif %}

{% elif A in ['mask', 'hash'] %}
  <div class="grid two">
    <label>Value / Param
      <input class="input" name="param_free" value="{{ param_free or '' }}" placeholder="mask→mask char; hash→salt">
    </label>
  </div>

{% elif A == 'hash_salt' %}
  <div class="grid two">
    <label>Salt
      <input class="input" name="param_free" value="{{ param_free or '' }}" placeholder="hash salt">
    </label>
  </div>

{% else %}
  <p class="muted">This action has no parameters.</p>
{% endif %}
